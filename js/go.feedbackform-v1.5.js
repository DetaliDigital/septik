var FBFvalidateFunction={};FBFvalidateFunction.radio=function($wr,$t){var validate=false;$wr.find("input[name='"+$t.attr('name')+"']").each(function(){if($(this).val().length){validate=true;console.log($(this).val());}});if(validate){return true;}else{$t.addClass("haserror");return false;}}
FBFvalidateFunction.checkbox=function($wr,$t){var validate=false;$wr.find("input[name='"+$t.attr('name')+"']:checked").each(function(){if($(this).val().length){validate=true;}});if(validate){return true;}else{$t.parent().addClass("haserror");return false;}}
FBFvalidateFunction.email=function($wr,$t){var email=$t.val();var re=/\S+@\S+\.\S+/;if(re.test(email)){return true;}else{$t.addClass("haserror");return false;}}
var FBFerror="<div class='fbf_error_wr'>Заполнены не все обязательные поля..</div>";$(document).ready(function(){$(document.body).on("click",".ajaxgo",FBFsend);$(document.body).on("focus change","input, textarea",function(){$(this).removeClass("haserror");if($(this).parent().hasClass("haserror")){$(this).parent().removeClass("haserror");}$(".fbf_error_wr").remove();});function FBFsend(){var wr=$(this).parents(".feedBackWrapper");var validate=true;if($(this).hasClass("active")){return false;}$(this).addClass("active");wr.find(".isrequired").each(function(){if($(this).attr('data-validatefunction')){if(validate){validate=FBFvalidateFunction[$(this).data('validatefunction')](wr,$(this));}else{FBFvalidateFunction[$(this).data('validatefunction')](wr,$(this));}}else{if(!$(this).val().length){validate=false;$(this).addClass("haserror");}}});if(validate){var need={};need['header']="Контактная информация";need['fields']=[];wr.find("input, select, textarea").each(function(){var t=$(this);var fieldElement={};if(t.attr("data-title")){fieldElement['title']=t.data("title");}else{fieldElement['title']=t.attr("placeholder");}if(t.attr("data-linktitle")){fieldElement['linktitle']=t.data("linktitle");}if(t.attr('type')=='checkbox'||t.attr('type')=='radio'){if(t.prop('checked')!==true){return true;}}fieldElement['value']=t.val();need['fields'][need['fields'].length]=fieldElement;});need['fields'][need['fields'].length]={type:"text",title:"Страница",linktitle:$("h1").first().text(),value:window.location.href};output=JSON.stringify(need);$.ajax({type:"POST",data:{fbfdata:output},url:'js/mail.php',dataType:'json',success:function(data){wr.find(".bl").hide();wr.find(".wh").hide();wr.find(".fbf_tohide_sm").hide();$(".fancybox-inner").css('overflow','visible');wr.find(".successmsg").html(data.result);wr.find(".successmsg").fadeIn(300).css("display","inline-block");},error:function(xhr,ajaxOptions,thrownError){console.log(xhr.responseText);}});}else{if($(".fancybox-inner").length===0){$("html,body").animate({scrollTop:wr.find(".haserror").first().offset().top-50},"slow");}}$(this).removeClass("active");}});